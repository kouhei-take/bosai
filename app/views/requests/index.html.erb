<div class="container">
  <div class="row">
    <div class="col-xs-12 col-sm-4 col-sm-offset-1">

        <h2>Your Information</h2>

        <table class="table table-striped table-responsive">
          <tr><th>Name</th> <td><%= current_user.first_name + " " + current_user.last_name %> </td></tr>
          <tr><th>Email</th> <td><%= current_user.email  %></td></tr>
          <tr><th>Address</th> <td><%= current_user.address  %></td></tr>
          <tr><th>Phone Number</th> <td><%= current_user.phone_number %></td></tr>
          <tr><th>Organization</th> <td><%= current_user.organization.name %></td></tr>
          <tr><th>Evacuation Point</th> <td><%= current_user.evacuation_point %></td></tr>
        </table>
    </div>

    <div class="col-xs-12 col-sm-4 col-sm-offset-1">
      <h3>Map</h3>
        <div id="map2" style="width:500px; height:400px;"></div>
    </div>
  </div>

  <hr>

  <div class="row">
     <div class="col-xs-12 col-sm-4 col-sm-offset-1">

        <h2>Your Current Requests</h2>
          <H4>Total Number: <%= @requests.count %></H3>
          <% @requests.each do |r| %>
          <table class="table table-striped table-responsive">
              <tr><th>Category</th> <td> <%= r.category  %></td></tr>
              <tr><th>Priority</th> <td> <%= r.priority  %></td></tr>
              <tr><th>Status</th> <td> <%= r.status  %></td></tr>
              <tr><th>Items</th> <td> <%= r.items_requests.map {|i| "#{i.item.name}: #{i.quantity}"}.join(", ") if r.items_requests.present? %></td></tr>
      <!--         <tr><th>Created_at</th> <td> <%= r.created_at %></td></tr>
              <tr><th>Updated_at</th> <td> <%= r.updated_at %></td></tr>
       -->    </table>
          <% end %>

  <%= link_to 'Create New Request', new_user_request_path(current_user), class: "btn-lg btn-primary btn-text" %>

    <hr>

        <%= link_to 'Create New Request', new_user_request_path(current_user), class: "btn btn-warning" %>
      </div>

    <div class="col-xs-12 col-sm-4 col-sm-offset-1">

        <h2>Provide Help</h2>
          <form action="/requests/list" class="navbar-wagon-search pull-left">
            <input type="text" name="area" class="navbar-wagon-search-input" placeholder="Search Area">
            <button type="submit" class="navbar-wagon-search-btn">
              <i class="fa fa-search"></i>
            </button>
        </form>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXcOkvUgEyPGVoJakn9KZ59BQSMHWVkmU"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-marker-clusterer/1.0.0/markerclusterer_compiled.js"></script>
<script src="https://cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js"></script>
<script src="https://cdn.rawgit.com/apneadiving/Google-Maps-for-Rails/master/js_compilation/gmaps_google.js"></script>

<script type="text/javascript">
function initMap() {}

$(document).ready(function () {
  var handler = Gmaps.build('Google', {
    markers: {
      clusterer: undefined
    }
  });
  handler.buildMap({
    internal: {
      id: 'map2'
    }
  }, function () {
    markers = handler.addMarkers([
      {
        "lat": "<%= current_user.latitude %>",
        "lng": "<%= current_user.longitude %>",
      }
    ]);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
  });
});
</script>
