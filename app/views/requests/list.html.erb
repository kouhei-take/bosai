    <div id="wrapper">

      <div id="map"></div>
      <div id="over_map">Filter</div>
      <div id="search">Search</div>
      <div id="results">Request</div>


    </div>

    <% content_for(:after_js) do %>
      <script>
        var map;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
            zoom: 18,
            center: new google.maps.LatLng(<%= @requests.first.latitude %>, <%= @requests.first.longitude %>),
            mapTypeId: 'roadmap'
          });
          // var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';
          var fireImage = {
            url: '<%= asset_path('fire_image.png') %>',
            scaledSize: new google.maps.Size(30, 30),
          }
          var riceImage = {
            url: '<%= asset_path('rice_image.png') %>',
            scaledSize: new google.maps.Size(40, 40),
          }
          var medicalImage = {
            url: '<%= asset_path('medical_image.png') %>',
            scaledSize: new google.maps.Size(30, 30),
          }
          var icons = {
            fire: {
              icon: fireImage
            },
            relief: {
              icon: riceImage
            },
            medical: {
              icon: medicalImage
            },
            rescue: {
              icon: medicalImage
            }
            // library: {
            //   icon: iconBase + 'info-i_maps.png'
            // }
          };

        var requests = [
          <% @requests.each do |request| %>
        {
          position: new google.maps.LatLng(<%= request.latitude %>, <%= request.longitude %>),
          category: '<%= request.category %>', id: <%= request.id %>, user_id: <%= request.user_id %>, address: '<%= request.address %>', priority: '<%= request.priority %>', status: '<%= request.status %>', created_at: '<%= request.created_at %>', updated_at: '<%= request.updated_at %>'
        },
          <% end %>
          ];


          function createMarker(index) {
            var marker = new google.maps.Marker({
              position: requests[index].position,
              icon: icons[requests[index].category].icon,
              map: map,
              id: requests[index].id,
              category: requests[index].category,
              address: requests[index].address,
              priority: requests[index].priority,
              status: requests[index].status,
              created_at: requests[index].created_at,
              updated_at: requests[index].updated_at,
              // label: labels[i % labels.length]
            });
            marker.addListener('click', function(){
              // var contentString = marker.id.toString();
              // var infowindow = new google.maps.InfoWindow({
              //   content: contentString
              // });
              // infowindow.open(map, marker);
              $('#results').html('<p class="results-text">' + 'ID:  ' + marker.id + '</p>' + '<p class="results-text">' + 'Category:  ' + marker.category + '</p>'
                + '<p class="results-text">' + 'Address:  ' + marker.address + '</p>'
                + '<p class="results-text">' + 'Priority:  ' + marker.priority + '</p>'
                + '<p class="results-text">' + 'Status:  ' + marker.status + '</p>'
                + '<p class="results-text">' + 'Created at:  ' + marker.created_at + '</p>'
                + '<p class="results-text">' + 'Updated at:  ' + marker.updated_at + '</p>'
                )
              // ****put in erb to assign marker.id to ruby object
               $('#results').toggle()
               console.log(marker.id);
            });
            return marker;
          }
          // end of createMarker
  var markers = []
          for (i = 0; i < requests.length; i++) {
            markers.push(createMarker(i));
          }
          // end of for loop
           var markerCluster = new MarkerClusterer(map, markers,
                {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/ms'});
          // this is for clustering.. need to load marketclusterer
        }
        // end of init map
      </script>
      <!-- end of map script -->

      <%= javascript_include_tag "https://maps.googleapis.com/maps/api/js?key=#{ENV['GOOGLE_API_BROWSER_KEY']}&callback=initMap" %>
      <!-- <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=[key]&callback=initMap">
      </script> -->

      <%#= javascript_include_tag "https://maps.google.com/maps/api/js?libraries=places&key=#{ENV['GOOGLE_API_BROWSER_KEY']}" %>

      <script>
        $(document).ready(function() {
          $("#results").hide();
        });
      </script>

    </script>v
    <% end %>
